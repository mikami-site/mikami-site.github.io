<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>小説タイトル</title>
<link rel="stylesheet" href="style.css">
</head>

<body>

<header class="reader-header">
  <div class="header-inner">

    <h1 class="novel-title">小説タイトル</h1>

    <div class="reader-controls">
      フォント：
      <button onclick="setFont('gothic')">ゴシック</button>
      <button onclick="setFont('mincho')">明朝</button>

      &nbsp;&nbsp;

      文字サイズ：
      <button onclick="changeSize(-2)">−</button>
      <span id="fontSizeDisplay">18</span>px
      <button onclick="changeSize(2)">＋</button>

      &nbsp;&nbsp;

      表示：
      <button onclick="toggleWritingMode()">横 / 縦</button>
    </div>

    <div class="page-nav">
      <button onclick="prevPage()">← 前へ</button>
      <span id="pageIndicator">1</span>
      <button onclick="nextPage()">次へ →</button>
    </div>

  </div>
</header>

<main class="container">

  <div id="page1" class="novel-section">
    ここに本文１を書きます。
  </div>

  <div id="page2" class="novel-section">
    ここに本文２を書きます。
  </div>

  <div id="page3" class="novel-section">
    ここに本文３を書きます。
  </div>

  <div id="page4" class="novel-section">
    ここに本文４を書きます。
  </div>

</main>

<script>
let currentSize = 18;
let currentPage = 1;
const totalPages = 4;

/* ===== ページ表示 ===== */
function showPage(pageNumber) {
  if (pageNumber < 1 || pageNumber > totalPages) return;

  currentPage = pageNumber;

  const pages = document.querySelectorAll('.novel-section');
  pages.forEach(p => p.style.display = 'none');

  const target = document.getElementById('page' + pageNumber);
  if (target) target.style.display = 'block';

  document.getElementById('pageIndicator').textContent = currentPage;

  applySettings();
  adjustLayout();

  window.scrollTo(0, 0);
}

/* 前へ */
function prevPage() {
  if (currentPage > 1) showPage(currentPage - 1);
}

/* 次へ */
function nextPage() {
  if (currentPage < totalPages) showPage(currentPage + 1);
}

/* フォント */
function setFont(type) {
  localStorage.setItem('fontType', type);
  applySettings();
  adjustLayout();
}

/* サイズ変更 */
function changeSize(amount) {
  currentSize += amount;

  if (currentSize < 12) currentSize = 12;
  if (currentSize > 36) currentSize = 36;

  localStorage.setItem('fontSize', currentSize);
  applySettings();
  adjustLayout();
}

/* 縦横切替 */
function toggleWritingMode() {
  const visible = document.querySelector('.novel-section[style*="block"]');
  if (!visible) return;

  visible.classList.toggle('vertical-mode');

  const isVertical = visible.classList.contains('vertical-mode');
  localStorage.setItem('writingMode', isVertical ? 'vertical' : 'horizontal');

  adjustLayout();
}

/* 設定適用 */
function applySettings() {
  const visible = document.querySelector('.novel-section[style*="block"]');
  if (!visible) return;

  visible.style.fontSize = currentSize + 'px';
  document.getElementById('fontSizeDisplay').textContent = currentSize;

  const savedFont = localStorage.getItem('fontType');
  visible.style.fontFamily =
    savedFont === 'mincho'
      ? '"Hiragino Mincho ProN","Yu Mincho","MS Mincho",serif'
      : '"Hiragino Kaku Gothic ProN","Yu Gothic","Meiryo",sans-serif';

  const savedWriting = localStorage.getItem('writingMode');
  visible.classList.toggle('vertical-mode', savedWriting === 'vertical');
}

/* ヘッダー高さ補正 */
function adjustLayout() {
  const header = document.querySelector('.reader-header');
  const container = document.querySelector('.container');
  container.style.marginTop = header.offsetHeight + 'px';
}

/* 初期化 */
window.addEventListener('load', function () {
  const savedSize = localStorage.getItem('fontSize');
  if (savedSize) currentSize = parseInt(savedSize);

  showPage(1);
});

window.addEventListener('resize', adjustLayout);

</script>
</body>
</html>
